#
# test_opt v3.0 -*- Perl -*-
#
# Testing harness for the opt_depot scripts
#
#************************************************************************
#
# Copyright (C) 1993-2003  The University of Texas at Austin.
#
#    This program is free software; you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation; either version 2 of the License, or
#    (at your option) any later version.
#
#    This program is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with this program; if not, write to the Free Software
#    Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
#    02111-1307, USA
#
#    Written by: Computer Science Division, Applied Research Laboratories,
#    University of Texas at Austin  opt-depot@arlut.utexas.edu
#
#***********************************************************************
# Written by Jonathan Abbey
# 10 September 2003
#
# Release: $Name:  $
# Version: $Revision: 1.2 $
# Last Mod Date: $Date: 2003/09/11 00:02:25 $
#
#####################################################################

use English;
use FindBin qw($RealBin);

use lib "$RealBin/../modules";
use Opt_depot::Common;

$version = "3.0";

## defaults #########################################################

$test_dir = "/tmp/opt_suite/base";
$test_logdir = "/tmp/opt_suite/log";
$test_etc = "/tmp/opt_suite/etc";

#####################################################################

$testconf1 << "ENDTESTCONF1";
Base: $test_dir
Depot: $test_dir/depot
Log: $test_logdir/opt_depot.log
SiteFile: $test_etc/sites
Subdirs: bin,include,info,lib,man
AlwaysRecurse: No
Recurse: include,lib,info
EOCONF

$testsites1 << "ENDSITES1";
ENDSITES1

%test1 = (label => 'Elementary recursion test',
	  start => ['depot/packA/bin/hi',
		    'depot/packA/lib/perl5/spam/x.pl',
		    'depot/packA/include/test.h',
		    'depot/packB/bin/hi',
		    'depot/packB/lib/perl5/spam/y.pl',
		    'depot/packB/include/test.h'],
	  end =>   ['bin/', 'lib/', 'man/', 'include/',
		    'bin/hi->depot/packA/bin/hi',
		    'lib/perl5/spam/x.pl->depot/packA/lib/perl5/spam/x.pl',
		    'lib/perl5/spam/y.pl->depot/packB/lib/perl5/spam/y.pl',
		    'include/test.h->depot/packB/include/test.h'],
	 conf =>   $testconf1,
	 sites =>  $testsites1);

@tests = (\%test1);	  

#####################################################################
#
# mkdir $test_dir
# mkdir $test_dir/depot
#
# touch a bunch of stuff
# run opt_depot
# test
#####################################################################

create_dir($test_dir);
create_dir($test_logdir);
create_dir($test_etc);
